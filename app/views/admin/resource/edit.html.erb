<% page_title "Editing: #{@record.to_title}" %>

<%= simple_form_for [:admin, @record], html: { multipart: @record.respond_to?(:audio), class: "form-horizontal" } do |f| %>
  <%= render 'errors', f: f %>
  <%= render 'form_fields', record: @record, f: f %>
  <%= submit_row @record, @persisted_record %>
<% end %>

<% content_for :sidebar do %>
  <ul class="story-status unstyled">
    <h5>Status</h5>
    <% if @record.respond_to? :status_text %>
      <li>This story is <span class="<%=status_bootstrap_map[@record.status]%>"><%= @record.status_text %></span></li>
    <% end %>
    <li>
      <a href="<%= admin_history_path(@record.class.route_key, @record.id) %>" title="history">
        Last Updated <strong><%= format_date @record.updated_at, time: true %></strong>
      </a>
    </li>
  </ul>
  
  <hr />
  
  <div id="fixed-sidebar" data-spy="affix" data-offset-top="250">
    <!-- Be sure to change the data-offset-top attribute on this element if you move it vertically -->
    <%= render "/admin/shared/form_nav" %>
  
    <h5>Currently Editing on This Page</h5>
    <ul id="newsroom-edit_user-list" class="viewers"></ul>
  </div>
    
<% end %>

<% content_for :footerjs do %>
  <script type="text/javascript">
    newsroom = new scpr.Newsroom(
      '<%= j Rails.application.config.node.server %>', // server info
      "<%= j({ id: @record.obj_key, type: 'Active'}.to_json.html_safe) %>", // room info
      "<%= j admin_user.to_json.html_safe %>", // user info
      "<%= j @record.to_json.html_safe %>", // record info
      { el: "#newsroom-edit_user-list" }
    );
  </script>
<% end %>
