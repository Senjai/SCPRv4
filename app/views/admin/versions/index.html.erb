<% page_title "History" %>

<% if @object %>
  <%= render 'header', page_title: @PAGE_TITLE, object: @object %>
<% end %>

<table class="table table-striped index-list list-<%=model.route_key%>">
  <%= any_to_list? @versions, message: "This object has no logged history in the Rails CMS." do %>
    <thead>
      <tr>
        <th class="column-manage">Manage</th>
        <% list.columns.each do |column| %>
          <th><%= column.header %></th>
        <% end %>
      </tr>
    </thead>
    <tbody class="list">
      <% @versions.each do |version| %>
        <% record = version.versioned %>
        <% if record.present? %> <%# Has to be here in a case a story gets deleted from Django %>
          <tr class="versions">
            <td>
              <%= guard record.class do %>
                <%= link_to "View", admin_version_path(resources: record.class.route_key, resource_id: record.id, version_number: version.version_number), class: "btn" %>
              <% end %>
            </td>
            <% list.columns.each do |column| %>
              <td>
                <%= render_attribute column, version %>
              </td>
            <% end %>
          </tr>
        <% end %>
      <% end %>
    </tbody>
  <% end %>
</table>

<%= paginate @versions, theme: 'bootstrap', window: 4%>
