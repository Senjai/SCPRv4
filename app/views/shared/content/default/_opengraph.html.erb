<% content_for :opengraph do %>
  <% @META_DESCRIPT = h(content.teaser) %>
  <%# Use render_byline here to allow for content that doesn't have a "byline" method %>
  <% @META_AUTHOR = h(render_byline(content, false)) %>
  
  <%= cache ["opengraph", "v1", content] do %>
    <meta property="og:description" content="<%= h content.teaser %>">
    <meta property="og:title" content="<%= h content.short_headline %>">
    <meta property="og:type" content="<%= @OG_TYPE || "article" %>">
    <meta property="og:url" content="<%= content.remote_link_path %>"/>
    <meta name="twitter:card" value="summary">
    <meta name="twitter:site" value="@kpcc">
    <meta name="twitter:url" value="<%= content.remote_link_path %>">
    <meta name="twitter:title" value="<%= h content.short_headline %>">
    <meta name="twitter:description" value="<%= h content.teaser %>">
  
    <meta property="article:published_time" content="<%=content.published_at%>" />
    <meta property="article:modified_time" content="<%=content.updated_at%>" />

    <% if content.respond_to?(:category) && content.category.present? %>
    <meta property="article:section" content="<%=h(content.category.title)%>" />
    <% end %>


    <% if content.assets.present? %>
      <% if content.is_a?(VideoShell) && content.asset.native.present? %>
        <meta property="og:video:width" content="300" />
        <meta property="og:video:height" content="200" />
        <meta property="og:video" content="http://c.brightcove.com/services/viewer/federated_f9/bcpid1247178207001?isVid=1&amp;isUI=1&amp;playerKey=AQ~~,AAAAmtVKbGE~,pW41hkPiaos27C7knwyeOWQgVlG4w7v5&amp;videoId=<%=content.asset.native["videoid"] %>">
        <meta property="og:video:secure_url" content="https://secure.brightcove.com/services/viewer/federated_f9/bcpid1247178207001?isVid=1&amp;isUI=1&amp;playerKey=AQ~~,AAAAmtVKbGE~,pW41hkPiaos27C7knwyeOWQgVlG4w7v5&videoId=<%=content.asset.native["videoid"] %>&secureConnections=true">
        <meta property="og:video:type" content="application/x-shockwave-flash"/>
        <meta name="twitter:player" value="https://secure.brightcove.com/services/viewer/federated_f9/bcpid1247178207001?isVid=1&amp;isUI=1&amp;playerKey=AQ~~,AAAAmtVKbGE~,pW41hkPiaos27C7knwyeOWQgVlG4w7v5&videoId=<%=content.asset.native["videoid"] %>&secureConnections=true">
        <meta name="twitter:player:width" value="300">
        <meta name="twitter:player:height" value="200">
      <% else %>

        <% content.assets.map(&:full).each do |image| %>
        <meta property="og:image" content="<%=image.url%>" />
        <meta property="og:image:type" content="image/jpeg" />
        <meta property="og:image:width" content="<%=image.width%>" />
        <meta property="og:image:height" content="<%=image.height%>" />
        <% end %> <%# assets %>

      <% end %>
        
      <link rel="image_src" href="<%= content.asset.full.url %>" />
      <meta name="twitter:image" value="<%= content.asset.full.url %>">
    <% end %>

  <% end %>
<% end %>
